# Uniclip-rs
A fork of [Uniclip - Universal Clipboard](https://github.com/quackduck/uniclip) in rust. This program can sync clipboard content between multiple devices as long as they are connected to the same network.
## Disclaimer
This software is created for educational and experimental purposes. It has not undergone professional security audits or rigorous stress testing. By using this software, you acknowledge the following risks:

1. Network Exposure & Security
- No Encryption: All network traffic generated by this software is unencrypted. Sensitive data, credentials, or commands sent through this application are visible to anyone with access to the network path.
- Restricted Environment: I strongly recommend against exposing this software to the public internet or any network, including LAN.
- Recommended Use: Use this project only within a private network on localhost for syncing clipboard contents between VMs.

2. Stability & Testing
- Limited Testing: This project has not been subjected to extensive automated or manual testing.
- Unpredictable Behavior: The software may be unstable, crash unexpectedly, or cause unintended side effects on the host system. It is provided "as-is" without any warranties of any kind.

3. Liability
The author(s) shall not be held liable for any data loss, security breaches, or system failures resulting from the use of this software. Use it at your own risk.

## Supports
### Format
- :white_check_mark: Text
- :white_check_mark: Image
- :x: Password (Not possible as [Arboard](https://github.com/1Password/arboard/) does not support capturing MIME type.)
- :white_large_square: File
- :white_large_square: Multiple files

### Platforms
- :white_check_mark: Windows
- :white_check_mark: MacOS
- :white_check_mark: X11
- :white_check_mark: Wayland

### Tested
- :white_large_square: Windows
- :white_check_mark: MacOS
- :white_large_square: X11
- :white_check_mark: Wayland

## Usage
```
Usage: uniclip-rs [OPTIONS] <CONNECTION_STRING>

Arguments:
  <CONNECTION_STRING>  Server/Bind address. (e.g. "127.0.0.1:12345")

Options:
  -s
          Use this option to start the server
  -p, --paste-server-clipboard
          Overwrite the clipboard by Server's clipboard content on start
  -a, --allowed-time-diff <ALLOWED_TIME_DIFF>
          Allowed time difference between client and server [default: 30]
      --keep-alive <KEEP_ALIVE>
          Interval to send keep alive packet [default: 30]
  -m, --max-message-size <MAX_MESSAGE_SIZE>
          Maximum message size in MB [default: 50]
      --sync-interval <SYNC_INTERVAL>
          Interval to sync clipboard between client and server [default: 60]
      --timeout-sec <TIMEOUT_SEC>
          Timeout for network requests in second [default: 3]
      --clipboard-poll-freq-ms <CLIPBOARD_POLL_FREQ_MS>
          Interval to poll from the system clipboard in millisecond [default: 500]
  -h, --help
          Print help
  -V, --version
          Print version
```

## Use App2Unit script to start it as a systemd unit
[App2unit](https://github.com/Vladimir-csp/app2unit) is a light weight bash script to launch apps as systemd user units. This can enroll uniclip-rs to your session manager (e.g. [UWSM](https://github.com/Vladimir-csp/uwsm)).
I also added auto restart properties into the service.
```bash
  app2unit -s s -t service -d \"Uniclip-rs clipboard sharing\" -p Restart=always -p RestartSec=5 -- uniclip-rs [add your options here] host:port
```

## Installaltion guide for NixOS users
1. Add the following to your `inputs`.
```nix
  uniclip = {
    url = "github:yurinek0/uniclip-rs";
    inputs.nixpkgs.follows = "nixpkgs";
  };
```
2. Add the following overlay.
```nix
  (final: prev: {
    uniclip = inputs'.uniclip.packages.uniclip;
  })
```
3. Add `pkgs.uniclip` to your home-manager packages.
4. Optional: Auto start after login.
  - There are multiple ways to achieve this. I recommend to start it with your compositor. Here is an example config for niri.
  - ```nix
      programs.niri.settings = {
        spawn-at-startup = [
          {
            sh = "app2unit -s s -t service -d \"Uniclip-rs clipboard sharing\" -p Restart=always -p RestartSec=5 -- uniclip-rs -p ${self.meta.qemu-host.ip}:${self.meta.qemu-host.uniclip-port}";
          }
        ];
      };
    ```
  - Source: [qemu-guest.nix](https://github.com/YuriNek0/dotfiles/blob/nixos/users/yuri/qemu-guest.nix)

## Contributing

Before commiting to the repo, use the following command to set the git hook path. A script to update *cargoHash* flake.nix will be executed automatically. Please make sure you have nix and nix-update installed.

```sh
  git config core.hooksPath .githooks
```

(This can be done with github workflow. However, considering the small scale of the project, I do not think it is necessary at the current stage. Pull requests are welcomed!)
